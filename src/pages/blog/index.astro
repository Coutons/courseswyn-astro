---
import MainLayout from "../../layouts/MainLayout.astro";
import { getCollection } from "astro:content";

// Get latest blog posts for blog index page
const posts = await getCollection('blog');
const latestPosts = posts
  .sort((a, b) => {
    const dateA = a.data.updatedAt || a.data.pubDate;
    const dateB = b.data.updatedAt || b.data.pubDate;
    return dateB.getTime() - dateA.getTime();
  })
  .slice(0, 12); // Show 12 posts per page for blog index

// Date formatting function
function formatDate(post: any) {
  const isUpdated = !!post.data.updatedAt;
  const date = post.data.updatedAt || post.data.pubDate;
  const formatted = new Intl.DateTimeFormat('en-US', {
    year: 'numeric',
    month: 'short',
    day: 'numeric',
  }).format(date);
  return isUpdated ? `Updated ${formatted}` : formatted;
}

const title = "Udemy Course Reviews & Learning Guides | Courses Wyn";
const description = "Discover the latest Udemy course reviews, in-depth tutorials, and expert learning guides. Find the best courses for your skill development journey.";
const canonical = "https://courseswyn.com/blog/";

const structuredData = {
  "@context": "https://schema.org",
  "@type": "Blog",
  headline: title,
  description: description,
  url: canonical,
  blogPost: latestPosts.map((post: any) => ({
    "@type": "BlogPosting",
    headline: post.data.title,
    description: post.data.description,
    url: `https://courseswyn.com/blog/${post.slug}/`,
    datePublished: post.data.pubDate.toISOString(),
    author: {
      "@type": "Person",
      name: "Josh Smith",
      url: "mailto:coutonscom@gmail.com",
    },
  }))
};
---

<MainLayout
  title={title}
  description={description}
  canonical={canonical}
  structuredData={structuredData}
>
  <div class="bg-[#1c252e] min-h-screen pb-20">

    <!-- Hero Section -->
    <div class="bg-gradient-to-br from-[#1c252e] via-[#1e293b] to-[#1c252e] pt-24 pb-16">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center">
          <h1 class="text-4xl md:text-6xl font-black text-white mb-6 leading-tight">
            Udemy Course Reviews &
            <span class="text-transparent bg-clip-text bg-gradient-to-r from-[#10b981] to-[#3b82f6]">Learning Guides</span>
          </h1>
          <p class="text-xl md:text-2xl text-gray-300 font-medium mb-6">
            Expert Insights, Tutorials & Reviews â€¢ Fresh Content Daily
          </p>
          <p class="text-gray-400 max-w-3xl mx-auto leading-relaxed mb-10 text-lg">
            Browse our comprehensive collection of Udemy course reviews, learning guides, tutorials, and expert insights to help you choose the perfect courses for your skill development journey.
          </p>

          <!-- Quick Stats -->
          <div class="grid grid-cols-2 md:grid-cols-4 gap-8 mb-12 max-w-3xl mx-auto border-t border-b border-[#2d3748] py-8">
            <div>
              <div class="text-4xl font-black text-[#10b981]">{latestPosts.length}</div>
              <div class="text-gray-500 text-sm font-bold uppercase tracking-wider mt-1">Latest Posts</div>
            </div>
            <div>
              <div class="text-4xl font-black text-[#10b981]">{posts.length}</div>
              <div class="text-gray-500 text-sm font-bold uppercase tracking-wider mt-1">Total Articles</div>
            </div>
            <div>
              <div class="text-4xl font-black text-[#10b981]">90%</div>
              <div class="text-gray-500 text-sm font-bold uppercase tracking-wider mt-1">Success Rate</div>
            </div>
            <div>
              <div class="text-4xl font-black text-[#10b981]">24/7</div>
              <div class="text-gray-500 text-sm font-bold uppercase tracking-wider mt-1">Updates</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Latest Posts Grid -->
    <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-20">
      <div class="flex items-center gap-3 mb-8">
        <span class="w-1.5 h-8 bg-[#10b981] rounded-full"></span>
        <h2 class="text-2xl font-bold text-white">Latest Articles</h2>
      </div>

      {latestPosts.length > 0 ? (
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12">
          {latestPosts.map((post: any) => (
            <a
              href={`/blog/${post.slug}/`}
              class="group block bg-[#28323d] border border-[#2d3748] rounded-2xl overflow-hidden hover:border-[#10b981] hover:shadow-xl hover:shadow-[#10b981]/10 transition-all duration-300 hover:-translate-y-2"
            >
              <!-- Image -->
              <div class="relative aspect-[16/9] overflow-hidden">
                <img
                  src={post.data.image?.src || post.data.image || 'https://images.unsplash.com/photo-1526379095098-d400fd0bf935?w=800&h=400&fit=crop'}
                  alt={post.data.title}
                  class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
                  loading="lazy"
                />
                {post.data.tags && post.data.tags[0] && (
                  <div class="absolute top-4 left-4">
                    <span class="bg-[#1c252e]/80 backdrop-blur-md text-green-400 text-[10px] font-bold px-2 py-1 rounded-md border border-green-500/30 uppercase tracking-wider">
                      {post.data.tags[0]}
                    </span>
                  </div>
                )}
              </div>

              <!-- Content -->
              <div class="p-6">
                <div class="flex flex-wrap items-center gap-2 mb-3 text-xs text-gray-400">
                  <div class="flex items-center gap-1.5 bg-[#1f2937] px-2 py-1 rounded border border-[#374151]">
                    <img src="/assets/authors/josh-smith.png" alt="Josh Smith" class="w-5 h-5 rounded-full object-cover border border-[#10b981]/30" />
                    <span class="truncate max-w-[80px] text-white font-medium">
                      Josh Smith
                    </span>
                  </div>
                  <span>â€¢</span>
                  <span>{formatDate(post)}</span>
                </div>

                <h3 class="font-bold text-white text-lg mb-3 leading-tight group-hover:text-[#10b981] transition-colors line-clamp-2">
                  {post.data.title}
                </h3>

                <p class="text-gray-400 text-sm leading-relaxed line-clamp-3 mb-4">
                  {post.data.description}
                </p>

                <!-- Read More -->
                <div class="flex items-center justify-between">
                  <span class="inline-block px-4 py-2 bg-[#10b981]/10 border border-[#10b981]/30 text-[#10b981] text-xs font-bold rounded-lg group-hover:bg-[#10b981] group-hover:text-white transition-all">
                    Read Article â†’
                  </span>
                </div>
              </div>
            </a>
          ))}
        </div>
      ) : (
        <div class="text-center py-16">
          <div class="text-gray-400 text-lg mb-4">No articles found</div>
        </div>
      )}

      <!-- View More Articles -->
      <div class="text-center">
        <a
          href="/blog/page/2"
          class="inline-block px-8 py-4 bg-[#28323d] border border-[#2d3748] text-white rounded-xl hover:border-[#10b981] transition-all font-medium"
        >
          View More Articles â†’
        </a>
      </div>
    </section>

    <!-- Featured Course Section -->
    <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-20">
      <div class="text-center mb-12">
        <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">
          ðŸ”¥ Udemy Personal Plan Coupon Code
        </h2>
        <p class="text-gray-400 text-lg max-w-2xl mx-auto">
          Get unlimited access to 26,000+ top Udemy courses, anytime, anywhere. Learn the skills you need to reach your goals.
        </p>
      </div>

      <div class="max-w-2xl mx-auto">
        <div class="bg-[#28323d] border border-[#2d3748] rounded-2xl p-8 hover:border-[#10b981] transition-all">
          <div class="text-center mb-6">
            <h3 class="font-bold text-white text-xl mb-2">Udemy Personal Plan</h3>
            <p class="text-gray-400 text-sm">Unlimited access to 26,000+ top Udemy courses</p>
          </div>

          <div class="flex items-center justify-center gap-4 mb-6">
            <div class="flex text-yellow-400">
              {"â˜…".repeat(5)}
            </div>
            <span class="text-gray-400">4.6 (400,000+ students)</span>
          </div>

          <div class="flex items-center justify-center gap-2 mb-6">
            <span class="text-green-400 font-bold text-3xl">$48.99</span>
            <span class="text-gray-500 line-through text-xl">$499.99</span>
            <span class="bg-red-500 text-white px-3 py-1 rounded text-sm font-bold">90% OFF</span>
          </div>

          <a
            href="https://trk.udemy.com/c/6564357/3775958/39854"
            target="_blank"
            rel="nofollow noopener noreferrer"
            class="block w-full bg-[#10b981] hover:bg-[#059669] text-white font-bold py-4 px-6 rounded-lg text-center transition-all shadow-lg hover:shadow-[#10b981]/40"
          >
            ðŸŽ“ Enroll Now - Limited Time Offer
          </a>
        </div>
      </div>
    </section>

  </div>
</MainLayout>
