---
// src/components/CourseDetailSchema.astro
const { course } = Astro.props;

// Correct hierarchical structured data
const structuredData = {
  "@context": "https://schema.org",
  "@type": "Course",
  name: course.title,
  description: course.description,
  "provider": {
    "@type": "EducationalOrganization",
    "name": "Udemy",
    "url": "https://www.udemy.com"
  },
  "instructor": {
    "@type": "Person",
    "name": course.instructor
  },
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD",
    "availability": new Date(course.expiresAt) > new Date() ? "https://schema.org/InStock" : "https://schema.org/OutOfStock",
    "validFrom": course.lastVerified,
    "validThrough": course.expiresAt,
    "url": course.affiliateLink,
    "seller": {
      "@type": "Organization",
      "name": "Udemy"
    }
  },
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": course.rating,
    "reviewCount": course.students,
    "bestRating": 5,
    "worstRating": 1
  },
  "educationalLevel": course.level,
  "timeRequired": `PT${course.duration}H`,
  "about": course.category,
  "image": course.imageUrl,
  "dateModified": new Date().toISOString()
};
---

<script is:inline type="application/ld+json" set:html={JSON.stringify(structuredData)}></script>
