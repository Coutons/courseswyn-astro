---
interface Props {
  category?: string;
  subCategory?: string;
  courseTitle?: string;
  isCategoryPage?: boolean;
  isSubCategoryPage?: boolean;
}

const { category, subCategory, courseTitle, isCategoryPage, isSubCategoryPage } = Astro.props;
---

<nav aria-label="Breadcrumb" class="mx-auto max-w-6xl px-4 py-4 border-b border-gray-200">
  <ol class="flex items-center gap-2 text-sm">
    <li>
      <a href="/" class="hover:text-purple-600 transition-colors font-medium text-gray-600">
        Home
      </a>
    </li>
    <li class="text-gray-400">/</li>
    <li>
      <a href="/coupon/" class="hover:text-purple-600 transition-colors font-medium text-gray-600">
        Coupons
      </a>
    </li>
    {category && (
      <>
        <li class="text-gray-400">/</li>
        <li>
          {isCategoryPage ? (
            <span class="font-medium text-gray-900">
              {category.replace(/-/g, " ")}
            </span>
          ) : (
            <a
              href={`/coupon/${category.toLowerCase().replace(/\s+/g, '-')}/`}
              class="hover:text-purple-600 transition-colors font-medium text-gray-600"
            >
              {category.replace(/-/g, " ")}
            </a>
          )}
        </li>
      </>
    )}
    {subCategory && (
      <>
        <li class="text-gray-400">/</li>
        <li>
          {isSubCategoryPage ? (
            <span class="font-medium text-gray-900">
              {subCategory}
            </span>
          ) : (
            <a
              href={`/coupon/${category!.toLowerCase().replace(/\s+/g, '-')}/${subCategory.toLowerCase().replace(/\s+/g, '-').replace(/&/g, 'and').replace(/\//g, '-')}`}
              class="hover:text-purple-600 transition-colors font-medium text-gray-600"
            >
              {subCategory}
            </a>
          )}
        </li>
      </>
    )}
    {courseTitle && (
      <>
        <li class="text-gray-400">/</li>
        <li>
          <span class="font-medium text-gray-900">
            {courseTitle}
          </span>
        </li>
      </>
    )}
  </ol>
</nav>

<!-- Schema Markup -->
{category || subCategory ? (
  <script type="application/ld+json" set:html={
    JSON.stringify({
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "https://courseswyn.com/"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Coupons",
          "item": "https://courseswyn.com/coupon/"
        },
        ...(category ? [{
          "@type": "ListItem",
          "position": 3,
          "name": category.replace(/-/g, " "),
          "item": `https://courseswyn.com/coupon/${category.toLowerCase().replace(/\s+/g, '-')}/`
        }] : []),
        ...(subCategory && category ? [{
          "@type": "ListItem",
          "position": 4,
          "name": subCategory,
          "item": `https://courseswyn.com/coupon/${category.toLowerCase().replace(/\s+/g, '-')}/${subCategory.toLowerCase().replace(/\s+/g, '-').replace(/&/g, 'and').replace(/\//g, '-')}/`
        }] : []),
        ...(courseTitle ? [{
          "@type": "ListItem",
          "position": subCategory ? (category ? 5 : 4) : (category ? 4 : 3),
          "name": courseTitle,
          "item": `https://courseswyn.com/coupon/${courseTitle.toLowerCase().replace(/\s+/g, '-')}`
        }] : [])
      ]
    })
  } />
) : null}