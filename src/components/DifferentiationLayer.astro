---
// src/components/DifferentiationLayer.astro
interface Course {
  title: string;
  category: string;
  instructor: string;
  rating: number;
  lastVerified: string;
  marketDemand: 'high' | 'medium' | 'low';
  skillRelevance: 'high' | 'medium' | 'low';
  careerPath: {
    title: string;
    description: string;
    growth: string;
    salary: string;
  }[];
  alternatives: {
    title: string;
    reason: string;
    advantage?: string;
    consideration?: string;
  }[];
}

const { course } = Astro.props;

// Strategic differentiation content
const marketAnalysis = {
  demand: course.marketDemand,
  relevance: course.skillRelevance,
  year2025Relevance: String(course.lastVerified ?? '').includes('2024') || String(course.lastVerified ?? '').includes('2025'),
  careerAlignment: course.careerPath,
  alternatives: course.alternatives
};
---

<!-- Strategic Differentiation Layer - 2025 Relevance Analysis -->
<section class="differentiation-layer">
  <div class="section-header">
    <h2>ğŸ¯ Should You Take This Course in 2025?</h2>
    <p class="section-subtitle">Strategic analysis for career-focused learners</p>
  </div>

  <div class="analysis-grid">
    <!-- Market Demand Analysis -->
    <div class="analysis-card">
      <div class="card-header">
        <span class="card-icon">ğŸ“ˆ</span>
        <h3>Market Demand</h3>
      </div>
      <div class="card-content">
        <div class="demand-indicator {marketAnalysis.demand}">
          <span class="demand-label">
            {marketAnalysis.demand === 'high' ? 'High Demand' : 
             marketAnalysis.demand === 'medium' ? 'Medium Demand' : 'Low Demand'}
          </span>
        </div>
        <p class="demand-text">
          {marketAnalysis.demand === 'high' ? 
            'Strong job market demand for {course.category} skills in 2025' :
           marketAnalysis.demand === 'medium' ? 
            'Moderate demand with growth potential in {course.category}' :
            'Niche demand, consider career alignment carefully'}
        </p>
      </div>
    </div>

    <!-- Skill Relevance Analysis -->
    <div class="analysis-card">
      <div class="card-header">
        <span class="card-icon">ğŸ”§</span>
        <h3>Skill Relevance</h3>
      </div>
      <div class="card-content">
        <div class="relevance-indicator {marketAnalysis.relevance}">
          <span class="relevance-label">
            {marketAnalysis.relevance === 'high' ? 'Highly Relevant' : 
             marketAnalysis.relevance === 'medium' ? 'Moderately Relevant' : 'Limited Relevance'}
          </span>
        </div>
        <p class="relevance-text">
          {marketAnalysis.relevance === 'high' ? 
            'Current tools and technologies are actively used in industry' :
           marketAnalysis.relevance === 'medium' ? 
            'Skills are relevant but may require additional learning' :
            'Consider more modern alternatives or supplements'}
        </p>
      </div>
    </div>

    <!-- Freshness Analysis -->
    <div class="analysis-card">
      <div class="card-header">
        <span class="card-icon">ğŸ•</span>
        <h3>Content Freshness</h3>
      </div>
      <div class="card-content">
        <div class="freshness-indicator {marketAnalysis.year2025Relevance ? 'fresh' : 'outdated'}">
          <span class="freshness-label">
            {marketAnalysis.year2025Relevance ? 'Recently Updated' : 'May Need Updates'}
          </span>
        </div>
        <p class="freshness-text">
          {marketAnalysis.year2025Relevance ? 
            `Coupon verified ${course.lastVerified} - aligns with current marketplace signals` :
            `Last verified ${course.lastVerified} - verify coupon status and course freshness`}
        </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Career Path Analysis -->
  <div class="career-analysis">
    <h3>ğŸ“ Career Path Alignment</h3>
    <div class="career-paths">
      {course.careerPath.map((path: Course['careerPath'][number]) => (
        <div class="career-item">
          <span class="career-icon">ğŸ’¼</span>
          <div class="career-content">
            <h4>{path.title}</h4>
            <p>{path.description}</p>
            <div class="career-stats">
              <span class="stat">ğŸ“Š {path.growth}</span>
              <span class="stat">ğŸ’° {path.salary}</span>
            </div>
          </div>
        </div>
      ))}
    </div>
  </div>

  <!-- Time-to-Skill Analysis -->
  <div class="skill-timeline">
    <h3>â±ï¸ Time-to-Skill Expectation</h3>
    <div class="timeline">
      <div class="timeline-item">
        <div class="timeline-marker">ğŸ¯</div>
        <div class="timeline-content">
          <h4>Foundation (1-2 months)</h4>
          <p>Core concepts and basic applications</p>
        </div>
      </div>
      <div class="timeline-item">
        <div class="timeline-marker">ğŸš€</div>
        <div class="timeline-content">
          <h4>Intermediate (2-4 months)</h4>
          <p>Advanced features and practical projects</p>
        </div>
      </div>
      <div class="timeline-item">
        <div class="timeline-marker">ğŸ’¼</div>
        <div class="timeline-content">
          <h4>Job-Ready (4-6 months)</h4>
          <p>Portfolio-ready skills and industry applications</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Alternative Analysis -->
  {course.alternatives.length > 0 && (
    <div class="alternatives-section">
      <h3>ğŸ”„ Alternative Considerations</h3>
      <div class="alternatives-grid">
        {course.alternatives.map((alt: Course['alternatives'][number]) => (
          <div class="alternative-card">
            <h4>{alt.title}</h4>
            <p class="alternative-reason">{alt.reason}</p>
            <div class="alternative-comparison">
              <span class="comparison-item">
                {alt.advantage ? 'âœ…' : 'âš ï¸'} {alt.advantage || alt.consideration}
              </span>
            </div>
          </div>
        ))}
      </div>
    </div>
  )}

  <!-- Strategic Recommendation -->
  <div class="strategic-recommendation">
    <div class="recommendation-header">
      <span class="recommendation-icon">ğŸ¯</span>
      <h3>Strategic Recommendation</h3>
    </div>
    <div class="recommendation-content">
      <p class="recommendation-text">
        {marketAnalysis.demand === 'high' && marketAnalysis.relevance === 'high' && marketAnalysis.year2025Relevance ?
          'ğŸ”¥ HIGHLY RECOMMENDED - Strong market demand with current skills and recent updates' :
         marketAnalysis.demand === 'medium' && marketAnalysis.relevance === 'high' ?
          'âœ… RECOMMENDED - Good skills with moderate demand, consider supplemental learning' :
         marketAnalysis.demand === 'high' && marketAnalysis.relevance === 'medium' ?
          'âš ï¸ CONDITIONAL RECOMMENDED - Good demand but skills may need updating' :
          'ğŸ¤” EVALUATE CAREER FIT - Consider alternatives or additional training'}
      </p>
      <div class="action-items">
        <h4>Next Steps:</h4>
        <ul>
          {marketAnalysis.demand === 'high' && marketAnalysis.relevance === 'high' && (
            <li>âœ… Enroll now - optimal timing for 2025 market</li>
          )}
          {marketAnalysis.demand === 'medium' && (
            <li>ğŸ“š Combine with advanced courses for better positioning</li>
          )}
          {marketAnalysis.relevance === 'medium' && (
            <li>ğŸ”„ Plan for additional skill development</li>
          )}
          {!marketAnalysis.year2025Relevance && (
            <li>ğŸ• Contact instructor about content updates</li>
          )}
        </ul>
      </div>
    </div>
  </div>
</section>

<style>
.differentiation-layer {
  @apply bg-slate-900/40 border border-slate-800/70 rounded-[1.75rem] p-6 backdrop-blur-xl;
}

.section-header {
  @apply mb-6;
}

.section-header h2 {
  @apply text-2xl font-bold text-foreground mb-2;
}

.section-subtitle {
  @apply text-slate-400;
}

.analysis-grid {
  @apply grid md:grid-cols-3 gap-4 mb-6;
}

.analysis-card {
  @apply bg-slate-950/40 border border-slate-800/70 rounded-2xl p-4;
}

.card-header {
  @apply flex items-center gap-2 mb-3;
}

.card-icon {
  @apply text-xl;
}

.card-header h3 {
  @apply font-semibold text-foreground;
}

.card-content {
  @apply space-y-3;
}

.demand-indicator,
.relevance-indicator,
.freshness-indicator {
  @apply inline-flex px-3 py-1 rounded-full text-sm font-medium;
}

.demand-indicator.high {
  @apply bg-green-500/20 text-green-600 border border-green-500/30;
}

.demand-indicator.medium {
  @apply bg-yellow-500/20 text-yellow-600 border border-yellow-500/30;
}

.demand-indicator.low {
  @apply bg-red-500/20 text-red-600 border border-red-500/30;
}

.relevance-indicator.high {
  @apply bg-blue-500/20 text-blue-600 border border-blue-500/30;
}

.relevance-indicator.medium {
  @apply bg-orange-500/20 text-orange-600 border border-orange-500/30;
}

.relevance-indicator.low {
  @apply bg-red-500/20 text-red-600 border border-red-500/30;
}

.freshness-indicator.fresh {
  @apply bg-green-500/20 text-green-600 border border-green-500/30;
}

.freshness-indicator.outdated {
  @apply bg-orange-500/20 text-orange-600 border border-orange-500/30;
}

.demand-text,
.relevance-text,
.freshness-text {
  @apply text-sm text-slate-400;
}

.career-analysis {
  @apply mb-6;
}

.career-analysis h3 {
  @apply text-lg font-semibold text-foreground mb-4;
}

.career-paths {
  @apply space-y-4;
}

.career-item {
  @apply flex gap-3 p-4 bg-slate-950/30 border border-slate-800/70 rounded-2xl;
}

.career-icon {
  @apply text-xl mt-1;
}

.career-content h4 {
  @apply font-medium text-foreground mb-1;
}

.career-content p {
  @apply text-sm text-muted-foreground mb-2;
}

.career-stats {
  @apply flex gap-4 text-xs;
}

.stat {
  @apply px-2 py-1 bg-slate-900/60 border border-slate-800/70 rounded-full text-slate-400;
}

.skill-timeline {
  @apply mb-6;
}

.skill-timeline h3 {
  @apply text-lg font-semibold text-foreground mb-4;
}

.timeline {
  @apply space-y-4;
}

.timeline-item {
  @apply flex gap-3;
}

.timeline-marker {
  @apply w-8 h-8 rounded-full bg-primary/20 border border-primary/25 flex items-center justify-center text-sm font-bold text-primary flex-shrink-0;
}

.timeline-content {
  @apply flex-1;
}

.timeline-content h4 {
  @apply font-medium text-foreground mb-1;
}

.timeline-content p {
  @apply text-sm text-slate-400;
}

.alternatives-section {
  @apply mb-6;
}

.alternatives-section h3 {
  @apply text-lg font-semibold text-foreground mb-4;
}

.alternatives-grid {
  @apply grid md:grid-cols-2 gap-4;
}

.alternative-card {
  @apply bg-slate-950/40 border border-slate-800/70 rounded-2xl p-4;
}

.alternative-card h4 {
  @apply font-medium text-foreground mb-2;
}

.alternative-reason {
  @apply text-sm text-slate-400 mb-2;
}

.comparison-item {
  @apply text-sm text-slate-400;
}

.strategic-recommendation {
  @apply bg-slate-950/40 border border-primary/25 rounded-[1.75rem] p-6;
}

.recommendation-header {
  @apply flex items-center gap-2 mb-4;
}

.recommendation-icon {
  @apply text-2xl;
}

.recommendation-header h3 {
  @apply text-lg font-bold text-foreground;
}

.recommendation-content {
  @apply space-y-4;
}

.recommendation-text {
  @apply text-foreground font-medium leading-relaxed;
}

.action-items h4 {
  @apply font-medium text-foreground mb-2;
}

.action-items ul {
  @apply space-y-2;
}

.action-items li {
  @apply text-sm text-foreground;
}
</style>
