---
import coupons from "../data/coupons.json";

// Extract unique subcategories and create slugs
const subCategories = [...new Set(coupons.map(c => c.subcategory || c.subCategory).filter(Boolean))];

// Icon mapping for subcategories
const categoryIcons = {
  "Software Testing": '<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bug"><path d="m8 2 1.88 1.88"/><path d="M14.12 3.88 16 2"/><path d="M9 7.13v-1a3.003 3.003 0 1 1 6 0v1"/><path d="M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6"/><path d="M12 20v-9"/><path d="M6.53 9C4.6 8.8 3 7.1 3 5"/><path d="M6 13H2"/><path d="M3 21c0-2.1 1.7-3.9 3.8-4"/><path d="M20.97 5c0 2.1-1.6 3.8-3.5 4"/><path d="M22 13h-4"/><path d="M17.2 17c2.1.1 3.8 1.9 3.8 4"/></svg>',
  "AI & Machine Learning": '<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-brain"><path d="M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .52 5.886 3 3 0 1 0 5.202.972 2 2 0 0 0 5.602 0 3 3 0 1 0 5.202-.972 4 4 0 0 0 .52-5.886 4 4 0 0 0-2.526-5.77A3 3 0 1 0 12 5"/><path d="M9 13a4.5 4.5 0 0 0 3 4"/><path d="M6.003 5.125A3 3 0 0 0 6.401 6.5"/><path d="M3.477 10.896a4 4 0 0 1 .1-2.396"/><path d="M3.997 16.781a4 4 0 0 1-.447-2.396"/><path d="M6.402 17.771a3 3 0 0 1-1.199-1.271"/><path d="M15.325 12.131A3 3 0 0 1 15 13"/><path d="M15.325 7.869A3 3 0 0 1 15 7"/><path d="M17.599 6.5a3 3 0 0 1 .398-1.375"/><path d="M20.523 8.5a4 4 0 0 1 .1 2.396"/><path d="M20.45 14.385a4 4 0 0 1-.447 2.396"/><path d="M18.797 16.5a3 3 0 0 1-1.198 1.271"/></svg>',
  "Software Development Tools": '<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-wrench"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>',
  "Cloud Computing": '<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cloud"><path d="M17.5 19c3.037 0 5.5-2.463 5.5-5.5 0-2.799-2.083-5.11-4.785-5.457A7.44 7.44 0 0 0 11 3a7.445 7.445 0 0 0-6.715 4.043C1.72 7.567 0 10.09 0 13c0 3.314 2.686 6 6 6Z"/></svg>',
  "Web Development": '<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-code"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>',
  "Data Analytics": '<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bar-chart-3"><path d="M3 3v18h18"/><path d="M18 17V9"/><path d="M13 17V5"/><path d="M8 17v-3"/></svg>',
  "Java & Mobile": '<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-smartphone"><rect width="14" height="20" x="5" y="2" rx="2" ry="2"/><path d="M12 18h.01"/></svg>',
  "Python & Data Science": '<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-database"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M3 5V19A9 3 0 0 0 21 19V5"/><path d="M3 12A9 3 0 0 0 21 12"/></svg>'
};

const topSubCategories = subCategories.slice(0, 8).map(sub => ({
  name: sub,
  slug: sub.toLowerCase().replace(/[^a-z0-9]+/g, '-') + '-courses',
  icon: categoryIcons[sub] || '<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-tag"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg>'
}));
---
<header class="sticky top-0 z-50 border-b border-border bg-background/80 backdrop-blur-xl">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-16">
      <div class="flex items-center gap-3">
        <a href="/" class="flex items-center gap-2">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal h-5 w-5 text-primary"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg>
          <span class="text-xl font-bold text-foreground font-mono tracking-tight">Courses<span class="text-primary">Wyn</span></span>
        </a>
      </div>
      <nav class="hidden md:flex items-center gap-8">
        <div class="relative group">
          <a href="/coupon/" class="flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground transition-colors py-2">
            Best Coupons
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-3.5 w-3.5 transition-transform group-hover:rotate-180"><path d="m6 9 6 6 6-6"></path></svg>
          </a>
          <!-- Dropdown -->
          <div class="absolute top-full left-0 mt-1 w-64 p-2 bg-popover border border-border rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 translate-y-2 group-hover:translate-y-0">
             <div class="flex flex-col gap-1">
                {topSubCategories.map(sub => (
                  <a href={`/coupon/${sub.slug}`} class="flex items-center gap-3 px-3 py-2 text-sm text-muted-foreground hover:text-foreground hover:bg-muted/50 rounded-md transition-colors">
                    <span class="text-primary/70" set:html={sub.icon} />
                    {sub.name}
                  </a>
                ))}
                <div class="h-px bg-border my-1"></div>
                <a href="/coupon/" class="px-3 py-2 text-sm font-medium text-primary hover:bg-primary/5 rounded-md transition-colors flex items-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-list"><line x1="8" x2="21" y1="6" y2="6"/><line x1="8" x2="21" y1="12" y2="12"/><line x1="8" x2="21" y1="18" y2="18"/><line x1="3" x2="3.01" y1="6" y2="6"/><line x1="3" x2="3.01" y1="12" y2="12"/><line x1="3" x2="3.01" y1="18" y2="18"/></svg>
                  View All Coupons
                </a>
             </div>
          </div>
        </div>
        <a href="/blog/" class="text-sm text-muted-foreground hover:text-foreground transition-colors">Reviews</a>
        <a href="/providers" class="text-sm text-muted-foreground hover:text-foreground transition-colors">Providers</a>
        <a href="/compare" class="text-sm text-muted-foreground hover:text-foreground transition-colors">Compare</a>
        <a href="/coupon/" class="text-sm text-muted-foreground hover:text-foreground transition-colors">Coupons</a>
        <a href="https://trk.udemy.com/c/6564357/3193860/39854" class="bg-primary hover:bg-primary/90 text-primary-foreground px-4 py-2 rounded-md text-sm font-medium transition-colors">Get Promo Code</a>
      </nav>
      <button class="md:hidden text-muted-foreground hover:text-foreground" aria-label="Toggle menu">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu h-5 w-5"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg>
      </button>
    </div>
  </div>
</header>
